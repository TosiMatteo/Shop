<section class="container">

  <header class="header">Prodotti</header>

  <form class="filters" (submit)="$event.preventDefault()">
    <mat-form-field>
      <mat-label>Titolo</mat-label>
      <input matInput type="search" name="title" placeholder="Cerca per titolo"
      (input)="updateTitle($any($event.target).value)"/>
    </mat-form-field>
    <mat-form-field>
      <mat-label>Price Min</mat-label>
      <input matInput type="number" min="0" name="priceMin" placeholder="Prezzo minimo"
          (input)="updatePriceMin($any($event.target).value)"/>
    </mat-form-field>
    <mat-form-field>
      <mat-label>Price Max</mat-label>
      <input matInput type="number" min="0" name="priceMax" placeholder="Prezzo massimo"
             (input)="updatePriceMax($any($event.target).value)"/>
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Ordina</mat-label>
      <mat-select (selectionChange)="updateSort($any($event.value))">
        <mat-option value="dateAsc">Data</mat-option>
        <mat-option value="dateDesc">Data (inversa)</mat-option>
        <mat-option value="priceAsc">Prezzo</mat-option>
        <mat-option value="priceDesc">Prezzo (inv)</mat-option>
      </mat-select>
    </mat-form-field>
  </form>


  <mat-paginator
    [length]="(filteredProducts$ | async)?.length || 0"
    [pageSize]="pageSize"
    [pageIndex]="((page$| async) || 1) - 1"
    (page)="onPage($event)"
  >

  </mat-paginator>

    @for (p of paged$| async; track p.id) {
      <app-product-card [product]="p" (add)="onAdd($event)">
      </app-product-card>
    }


</section>
